import sys
sys.argv.append( '-b-' )


from ROOT import TFile, TH1F, gDirectory, TCanvas
from ROOT import gStyle
from ROOT import gROOT
from ROOT import TStyle
from ROOT import TLegend
from ROOT import TPaveText
from  Helpers import *
import os

colors=[1,2,3,4,5,6,7]


def OpenFile(filename,histVec):
    fin = TFile( filename,'READ' )
    fin.cd('NMinusOne')
    histogram = gDirectory.Get(histVec)
    print ("type in open file",type(histogram))
    histogram.SetDirectory(0)
    fin.Close()
    return histogram

def DrawOverlap(f,h, titleVec,legendtext,pngname,ifile,xRange=[-99999,99999,1]):
    histo = OpenFile(f,h)
    #histo={}
    SetStyle()
    leg = SetLegend()
    c   = SetCanvas()
    print "opening rootfiles"
    print "fetching histograms"
    print type(histo)
    nbins = histo.GetNbinsX()
    xlow  = histo.GetXaxis().GetXmin()
    xhigh = histo.GetXaxis().GetXmax()
    efficiency = TH1F(pngname,"efficiency",nbins,xlow,xhigh)
    
    for ibin in range(nbins):
        eff =  histo.Integral(ibin+1,nbins)/float(histo.Integral())
        efficiency.SetBinContent(ibin,eff)
        
    efficiency.Draw()
    efficiency.SetMaximum(1.0)
    efficiency.SetLineColor(2)
    efficiency.SetLineWidth(3)
    pt = SetPaveText()
    pt.Draw()
    leg.Draw()
    
    SavePlots(pngname,c)
    efficiency.SetDirectory(0)
    return efficiency

##
##print "calling the plotter"
##files=['../OutputRootFile/analysis.root','../OutputRootFile/analysis2.root',0]
##point=['1000','2000']
##ytitle='#e_{Signal}'
##legend=['M_{Z`} = 1000 GeV']
##
##fout = TFile('Out.root','RECREATE')
##fout.cd()
##
##
#### Add Histogram to Root File
###for ip in range(len(files)):
##h_name='FatJetCSV_'+point[0]
##FatJetCSV = DrawOverlap(files[0], 'NMinusOne/h_FatJetCSVbcsv',['CSIVv2',ytitle], legend,h_name,1)
###fout.cd()
###FatJetCSV.Write()
##
##h_name1='FatJetCSV1_'+point[1]
##FatJetCSV1 = DrawOverlap(files[1], 'NMinusOne/h_FatJetCSVbcsv',['CSIVv2',ytitle], legend,h_name1,[-99999,99999,1])
##fout.cd()
##FatJetCSV1.Write()
##
##                           
##
##
##
##
